import{j as e,a as l,R as T,F as k,b as D,d as M,c as F}from"./index-9kcKp_80.js";function L(){return e.jsx("div",{children:e.jsx("h1",{className:"title",children:"Clinical Trials"})})}function O(){const[o,p]=l.useState("NCT Number"),[i,S]=l.useState(""),[r,v]=l.useState([]),[b,N]=l.useState({}),[d,m]=l.useState(!1),[j,x]=l.useState(""),f=()=>{const s=new Date,t=s.getFullYear(),n=String(s.getMonth()+1).padStart(2,"0"),a=String(s.getDate()).padStart(2,"0"),h=String(s.getHours()).padStart(2,"0"),u=String(s.getMinutes()).padStart(2,"0"),c=String(s.getSeconds()).padStart(2,"0");return`${t}-${n}-${a}_${h}-${u}-${c}`},C=()=>{if(!r||r.length===0)return;const s=f(),t=[],n=Object.keys(r[0]);t.push(n.join(","));for(const $ of r){const w=n.map(E=>{const g=$[E];return g?`"${String(g).replace(/"/g,'""')}"`:""});t.push(w.join(","))}const a=t.join(`
`),h=new Blob([a],{type:"text/csv"}),u=URL.createObjectURL(h),c=document.createElement("a");c.href=u,c.download=`results_${s}.csv`,document.body.appendChild(c),c.click(),document.body.removeChild(c)},y=async()=>{if(!o||!i){alert("Please provide both search criteria and search term.");return}x(""),m(!0);try{const s=await D.post("/studies/",{column_name:o,search_term:i});v(s.data),s.data.length===0&&x("No results found.")}catch(s){console.error("Error fetching data:",s),alert("Failed to fetch results. Please try again later.")}finally{m(!1)}},R=(s,t)=>{const n=`${s}-${t}`;N(a=>({...a,[n]:!a[n]}))};return e.jsxs("div",{className:"clinical-container",children:[e.jsxs("div",{className:"header-container",children:[e.jsx("img",{src:T,className:"logo",alt:"Logo"}),e.jsx(L,{}),e.jsx("nav",{children:e.jsx("ul",{children:e.jsx("li",{children:e.jsx("a",{className:"navigation-link",href:"./..",children:"R&R Data"})})})})]}),e.jsxs("div",{className:"search-container card-container clinical-search",children:[e.jsxs("div",{children:[e.jsx("label",{children:"Select Criteria:"}),e.jsxs("select",{className:"searchbar-dropdown-clinical",value:o,onChange:s=>p(s.target.value),children:[e.jsx("option",{value:"NCT Number",children:"NCT Number"}),e.jsx("option",{value:"Phases",children:"Phases"}),e.jsx("option",{value:"Study Title",children:"Drug Name"})]})]}),e.jsx("input",{type:"text",value:i,onChange:s=>S(s.target.value),placeholder:"Enter search term"}),e.jsx("button",{className:"search-container-child",onClick:y,disabled:d,children:d?"Searching...":"Launch Search"})]}),j&&e.jsx("div",{className:"error-message",children:j}),e.jsx("div",{className:"results--container",children:r.length>0?e.jsxs("div",{className:"results-table-container clinical-table-container",children:[e.jsx("div",{children:e.jsxs("button",{onClick:C,className:"download-button",children:["Download CSV ",e.jsx("i",{className:"fa fa-download"})]})}),e.jsxs("table",{className:"results-table",children:[e.jsx("thead",{children:e.jsx("tr",{children:Object.keys(r[0]).map(s=>e.jsx("th",{children:s},s))})}),e.jsx("tbody",{children:r.map((s,t)=>e.jsx("tr",{children:Object.values(s).map((n,a)=>e.jsx("td",{className:b[`${t}-${a}`]?"expanded":"",onClick:()=>R(t,a),children:n},a))},t))})]})]}):!d&&e.jsx("p",{children:" "})}),e.jsx(k,{})]})}M.createRoot(document.getElementById("foot")).render(e.jsx(F.StrictMode,{children:e.jsx(O,{})}));
