import{j as e,a as l,R as E,F as k,b as D,d as M,c as F}from"./index-DhQNsYhv.js";function L(){return e.jsx("div",{children:e.jsx("h1",{className:"title",children:"Clinical Trials"})})}function O(){const[o,p]=l.useState(""),[i,S]=l.useState(""),[r,v]=l.useState([]),[b,N]=l.useState({}),[d,m]=l.useState(!1),[j,x]=l.useState(""),f=()=>{const t=new Date,s=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),a=String(t.getDate()).padStart(2,"0"),h=String(t.getHours()).padStart(2,"0"),u=String(t.getMinutes()).padStart(2,"0"),c=String(t.getSeconds()).padStart(2,"0");return`${s}-${n}-${a}_${h}-${u}-${c}`},C=()=>{if(!r||r.length===0)return;const t=f(),s=[],n=Object.keys(r[0]);s.push(n.join(","));for(const $ of r){const w=n.map(T=>{const g=$[T];return g?`"${String(g).replace(/"/g,'""')}"`:""});s.push(w.join(","))}const a=s.join(`
`),h=new Blob([a],{type:"text/csv"}),u=URL.createObjectURL(h),c=document.createElement("a");c.href=u,c.download=`results_${t}.csv`,document.body.appendChild(c),c.click(),document.body.removeChild(c)},y=async()=>{if(!o||!i){alert("Please provide both search criteria and search term.");return}x(""),m(!0);try{const t=await D.post("/studies/",{column_name:o,search_term:i});v(t.data),t.data.length===0&&x("No results found.")}catch(t){console.error("Error fetching data:",t),alert("Failed to fetch results. Please try again later.")}finally{m(!1)}},R=(t,s)=>{const n=`${t}-${s}`;N(a=>({...a,[n]:!a[n]}))};return e.jsxs("div",{className:"clinical-container",children:[e.jsxs("div",{className:"header-container",children:[e.jsx("img",{src:E,className:"logo",alt:"Logo"}),e.jsx(L,{}),e.jsx("nav",{children:e.jsx("ul",{children:e.jsx("li",{children:e.jsx("a",{className:"navigation-link",href:"./..",children:"R&R Data"})})})})]}),e.jsxs("div",{className:"search-container card-container clinical-search",children:[e.jsxs("div",{children:[e.jsx("label",{children:"Select Criteria:"}),e.jsxs("select",{className:"searchbar-dropdown-clinical",value:o,onChange:t=>p(t.target.value),children:[e.jsx("option",{value:"NCT Number",children:"NCT Number"}),e.jsx("option",{value:"Phases",children:"Phases"}),e.jsx("option",{value:"Study Title",children:"Study Title"}),e.jsx("option",{value:"Study Title",children:"Drug Name"})]})]}),e.jsx("input",{type:"text",value:i,onChange:t=>S(t.target.value),placeholder:"Enter search term"}),e.jsx("button",{className:"search-container-child",onClick:y,disabled:d,children:d?"Searching...":"Launch Search"})]}),j&&e.jsx("div",{className:"error-message",children:j}),e.jsx("div",{className:"results--container",children:r.length>0?e.jsxs("div",{className:"results-table-container clinical-table-container",children:[e.jsx("div",{children:e.jsxs("button",{onClick:C,className:"download-button",children:["Download CSV ",e.jsx("i",{className:"fa fa-download"})]})}),e.jsxs("table",{className:"results-table",children:[e.jsx("thead",{children:e.jsx("tr",{children:Object.keys(r[0]).map(t=>e.jsx("th",{children:t},t))})}),e.jsx("tbody",{children:r.map((t,s)=>e.jsx("tr",{children:Object.values(t).map((n,a)=>e.jsx("td",{className:b[`${s}-${a}`]?"expanded":"",onClick:()=>R(s,a),children:n},a))},s))})]})]}):!d&&e.jsx("p",{children:" "})}),e.jsx(k,{})]})}M.createRoot(document.getElementById("foot")).render(e.jsx(F.StrictMode,{children:e.jsx(O,{})}));
